<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/fontawesome.min.css" integrity="sha512-Rcr1oG0XvqZI1yv1HIg9LgZVDEhf2AHjv+9AuD1JXWGLzlkoKDVvE925qySLcEywpMAYA/rkg296MkvqBF07Yw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="./css/search.css">
  <title>DB Connect</title>
</head>
<body>
  <div class="fquery">
    <form id="f1" action="./search.php" method="post">
			
				<div class="categoria">
					<h3>Categoria: </h3>
					<select name="category">
						<option value="fatture">Fatture</option>
						<option value="scuola">Scuola</option>
						<option value="fisco">Finanze</option>
						<option value="casa">Spese Casa</option>
						<option value="auto">Spese Auto</option>
						<option value="multe">Mancati Pagamenti</option>
					</select>
				</div>

				<div class="nome">
					<h3>Descrizione:</h3>
					<input type="text" name="description" required="required" placeholder="Breve descrizione">
				</div>

				<div class="proprietario">
					<h3>Proprietario:</h3>
					<select name="owner">
						<option value="naim">Naim Shala</option>
						<option value="yllka">Yllka Shala</option>
						<option value="klaus">Klaus Shala</option>
						<option value="daniel">Daniel Shala</option>
					</select>
				</div>

				<div class="data">
					<h3>Data:</h3>
					<input type="date" name="date">
				</div>

				<div class="send">
					<button type="submit" form="f1" value="Search" name="submit" class="button">Search</button>
				</div>
			
    </form>

  </div>

	<div class="wrapper">
		<div class="sql">
			<div class="riga">
				<div class="headings">CATEGORIA</div>
				<div class="headings">NOME</div>
				<div class="headings">OWNER</div>
				<div class="headings">DATA</div>
				<div class="headings">URL</div>
			</div>
			
			<?php
			require "./db/database.php";


			if (isset($_POST['submit'])) {
				$conn = new mysqli($servername, $username, $password, $dbname);

				if ($conn->connect_error) {
					die("Connection failed: " . $conn->connect_error);
				}

				$sql = "SELECT (category, name, owner, data, url) FROM documents";
				$result = $conn->query($sql);

				
				if ($result->num_rows > 0) {
					echo '<div class="riga">';
					while($row = mysqli_fetch_assoc($result)) {
						echo '<div class="cella">' . $row['category'] . '</div>';
						echo '<div class="cella">' . $row['name'] . '</div>';
						echo '<div class="cella">' . $row['owner'] . '</div>';
						echo '<div class="cella">' . $row['data'] . '</div>';
						echo '<div class="cella">' . '<i class="fa fa-file-pdf-o" aria-hidden="true" href="' . $row['url'] . '"></i>' . '</div>';
					}
					echo '</div>';
				}

			}

			?>
		</div>
	</div>
</body>
</html>